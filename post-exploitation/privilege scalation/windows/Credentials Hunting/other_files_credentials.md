https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/windows-privilege-escalation/#summary
# Otros Archivos para Caza de Credenciales (Windows Privilege Escalation)

## Resumen
Este capítulo describe cómo encontrar credenciales almacenadas en archivos locales o compartidos en red. Incluye técnicas manuales y automatizadas para buscar contraseñas en configuraciones, bases de datos, notas adhesivas y otros archivos del sistema que suelen contener información sensible.

---

## Archivos Locales y Compartidos

### Tipos de Archivos de Interés
- **Config files**: `.xml`, `.ini`, `.txt`, `.config` que pueden contener contraseñas en texto plano.
- **Bases de datos virtuales**: `.kdbx`, `.vmdk`, `.vhdx`.
- **Claves privadas SSH**: `.ppk`.
- **Documentos de usuario**: Excel, Word, OneNote o incluso `passwords.txt`.

### Herramientas
- **Snaffler**: Para rastrear unidades de red buscando extensiones sensibles.

---

## Búsqueda Manual de Credenciales

### Comandos para buscar en archivos
```cmd
cd c:\Users\htb-student\Documents & findstr /SI /M "password" *.xml *.ini *.txt
findstr /si password *.xml *.ini *.txt *.config
findstr /spin "password" *.*
```

### Buscar usando PowerShell
```powershell
select-string -Path C:\Users\htb-student\Documents\*.txt -Pattern password
```

### Buscar por extensiones específicas
```cmd
dir /S /B *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config*
where /R C:\ *.config
```

### PowerShell búsqueda por extensiones
```powershell
Get-ChildItem C:\ -Recurse -Include *.rdp, *.config, *.vnc, *.cred -ErrorAction Ignore
```

---

## Contraseñas en Sticky Notes

- Las notas adhesivas se guardan en `plum.sqlite` en la ruta:
  ```
  C:\Users\<user>\AppData\Local\Packages\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\LocalState\
  ```
- Se pueden extraer usando herramientas como **DB Browser for SQLite** o mediante **PowerShell** con el módulo `PSSQLite`:
```powershell
Invoke-SqliteQuery -Database plum.sqlite -Query "SELECT Text FROM Note" | ft -wrap
```

- También es posible analizar con `strings` en Linux:
```bash
strings plum.sqlite-wal | grep password
```

---

## Otros Archivos Relevantes

Algunos archivos del sistema que pueden contener credenciales o información útil:
- `%SYSTEMDRIVE%\pagefile.sys`
- `%WINDIR%\debug\NetSetup.log`
- `%WINDIR%\repair\sam`, `%WINDIR%\repair\system`
- `%WINDIR%\system32\config\security.sav`
- `%USERPROFILE%\ntuser.dat`
- `%WINDIR%\System32\drivers\etc\hosts`
- `C:\ProgramData\Configs\*`
- `C:\Program Files\Windows PowerShell\*`

---

## Recomendaciones
- Enumerar manualmente si las herramientas automáticas fallan.
- Revisar rutas de red compartidas con permisos laxos.
- Buscar credenciales en archivos temporales o de respaldo dejados por administradores.
