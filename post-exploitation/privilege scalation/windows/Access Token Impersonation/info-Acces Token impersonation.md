
# Introducción

Los **tokens de acceso en Windows** son un elemento clave en el proceso de autenticación y son creados y gestionados por el servicio **Local Security Authority Subsystem Service (LSASS)**.

Un **token de acceso** identifica y describe el contexto de seguridad de un proceso o hilo en ejecución. En términos simples, funciona como una clave temporal (similar a una cookie web) que permite a los usuarios acceder a un sistema o recurso sin tener que ingresar credenciales repetidamente.

Los **tokens de acceso** son generados por el proceso **winlogon.exe** cada vez que un usuario se autentica con éxito e incluyen la identidad y privilegios de la cuenta de usuario. Luego, el token se adjunta al proceso **userinit.exe**, y todos los procesos secundarios iniciados por el usuario heredan una copia del token, ejecutándose con los mismos privilegios.

# Windows Access Tokens - Niveles de Seguridad

Los **tokens de acceso en Windows** se categorizan según los **niveles de seguridad** asignados, los cuales determinan los privilegios del token.

## Tipos de tokens de acceso

Un token de acceso suele tener uno de los siguientes niveles de seguridad:

- **Tokens de nivel Impersonate**  
  - Se generan como resultado de un inicio de sesión **no interactivo**.  
  - Comúnmente creados por **servicios del sistema** o inicios de sesión en un **dominio**.  

- **Tokens de nivel Delegate**  
  - Se generan mediante un inicio de sesión **interactivo**.  
  - Se crean en inicios de sesión tradicionales o mediante protocolos de acceso remoto como **RDP**.  
## Riesgos y usos de los tokens

- **Tokens de nivel Impersonate**  
  - Permiten suplantar un usuario dentro del **sistema local**.  
  - **No pueden** ser utilizados en sistemas externos.  

- **Tokens de nivel Delegate**  
  - Representan un **mayor riesgo de seguridad**.  
  - Permiten suplantar la identidad en **cualquier sistema**, lo que los hace más peligrosos.  

    
# Suplantación de Tokens de Acceso en Windows

El proceso de **suplantación de tokens de acceso** para elevar privilegios en un sistema depende principalmente de:  
1. Los **privilegios** asignados a la cuenta que ha sido explotada para obtener acceso inicial.  
2. Los **tokens de suplantación (Impersonate) o delegación (Delegate)** disponibles.  

## Privilegios necesarios para un ataque de suplantación exitoso

Para realizar un ataque de **suplantación de tokens**, es necesario contar con uno o más de los siguientes privilegios:

- **SeAssignPrimaryToken**  
  - Permite a un usuario **suplantar tokens**.  

- **SeCreateToken**  
  - Permite a un usuario **crear un token arbitrario** con privilegios administrativos.  

- **SeImpersonatePrivilege**  
  - Permite a un usuario **crear un proceso** bajo el contexto de seguridad de otro usuario, generalmente con privilegios administrativos.  
