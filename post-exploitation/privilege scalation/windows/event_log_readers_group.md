# üõ°Ô∏è Event Log Readers y Auditor√≠a de Procesos en Windows

## üìå ¬øQu√© es el evento 4688?

El **evento 4688** se genera cuando se crea un nuevo proceso en Windows, si la auditor√≠a est√° habilitada.

Incluye:
- Nombre del proceso
- L√≠nea de comandos completa (si est√° habilitado)
- Usuario que ejecut√≥ el proceso

## üéØ ¬øPor qu√© es √∫til?

- Permite detectar comandos sospechosos o maliciosos.
- Puede capturar **credenciales** si se pasan en l√≠nea de comandos.
- Ideal para an√°lisis forense o detecci√≥n de amenazas.

## ‚úÖ Comprobar si la auditor√≠a est√° habilitada

### Ver desde pol√≠ticas locales (GUI)
1. Ejecutar `secpol.msc`
2. Ir a: `Directivas locales > Directiva de auditor√≠a`
3. Verificar que **Audit Process Creation** est√© en "√âxito"

### Ver desde PowerShell
```powershell
AuditPol /get /category:"Detailed Tracking"
```

### Ver si se registra la l√≠nea de comandos
```powershell
Get-ItemProperty "HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit" |
  Select ProcessCreationIncludeCmdLine_Enabled
```
- Resultado `1` = habilitado

## üë• Comprobar membres√≠a en Event Log Readers

### En CMD
```cmd
net localgroup "Event Log Readers"
```

### En PowerShell
```powershell
Get-LocalGroupMember "Event Log Readers"
```

## üîç Consultar logs con comandos

### Usar `wevtutil` (CMD)
```cmd
wevtutil qe Security /rd:true /f:text | findstr "user:"
```

Con credenciales:
```cmd
wevtutil qe Security /rd:true /f:text /r:share01 /u:julie.clay /p:Welcome1 | findstr "user:"
```

|Comando|Accede a|Necesita permisos de|Requiere login|
|---|---|---|---|
|`wevtutil qe Security`|Local|Tu usuario local|No|
|`wevtutil qe Security /r:<remoto> ...`|Remoto|Usuario con permisos|S√≠|
### Usar `Get-WinEvent` (PowerShell)
```powershell
Get-WinEvent -LogName Security |
  Where { $_.ID -eq 4688 -and $_.Properties[8].Value -like "*/user*" } |
  Select-Object @{Name="CommandLine"; Expression={ $_.Properties[8].Value }}
```

> ‚ö†Ô∏è Para usar `Get-WinEvent` sobre el log de seguridad necesitas permisos elevados o modificar el registro:
> `HKLM\System\CurrentControlSet\Services\Eventlog\Security`

## üí° Recomendaciones

- Audita procesos y registra l√≠neas de comandos.
- Usa herramientas gratuitas de Windows para monitorizaci√≥n si no tienes EDR.
- Aplica reglas con AppLocker para restringir comandos peligrosos.
