Las tareas cron se ejecutan en intervalos de tiempo determinados y ejecutan, por ejemplo scripts en bash para hacer un backup de algun fichero..etc.

Todos los usuarios pueden crear tareas cron.
Para saber las tareas cron creadas por el usuario actual se puede ver con `crontab -l`

Para elevar privilegios, nuestro target son las cron jobs creadas por el usuario root. Ya que, si somos capaces de editar un script en bash ejecutado en intervalos regulares de tiempo por el usuario root, escalaremos privilegios.

Ejemplo para buscar referencias en cualquier fichero que tenga la cadena "/home/student/message"
![[Pasted image 20250211190813.png]]


## Buscar ficheros modificables por cualquiera

```shell-session
find / -path /proc -prune -o -type f -perm -o+w 2>/dev/null
```

## Monitorar procesos con pspy

Para ver si en intervalos regulares de tiempo algún script se ejecuta. En el caso de que además sea editable por cualquiera, podemos escalar privilegios si el usuario que lo ejecuta es root y editamos el script para entablarnos una reverse shell, o cualquier cosa que se nos ocurra.
https://github.com/DominicBreuker/pspy
Ejecutarlo con:
```shell-session
./pspy64 -pf -i 1000
```

The `-pf` flag tells the tool to print commands and file system events and `-i 1000` tells it to scan [procfs](https://man7.org/linux/man-pages/man5/procfs.5.html) every 1000ms (or every second).