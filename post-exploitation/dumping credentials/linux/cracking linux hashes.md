Los hashes se encuentran en el archivo /etc/shadow. Sólo el usuario root tiene permisos de lectura sobre este fichero.
En el hash, tenemos entre "\$$" un valor, indica el tipo de algoritmo utilizado para encriptar. Es necesario saberlo a la hora de crackear decirle a la herramienta que algoritmo se utilizó.
![[Pasted image 20250305110828.png]]

Para obtener los hashes automáticamente y guardarlos en un txt, podemos usar el módulo de metasploit `post/linux/gather/hashdump`, como parámetros del módulo seleccionamos la sessión activa con meterpreter y run. Listo automáticamente copiará los hashes del /etc/shadow y los meterá en un fichero.

Una vez obtenidos los hashes y guardados en un fichero de texto, podemos crackearlos.
NOTA: 
Si hacemos un cat sobre el fichero de los hashes guardados, veremos que guarda toda la línea correspondiente al usuario, con toda la información, incluso de la shell que utiliza el usuario:
![[Pasted image 20250305111230.png]]
Si queremos hacerlo de forma manual, copiar toda la línea del usuario/usuarios.

## Crack linux hashes with John The Ripper
Viendo el hash vemos que es \$6$ por lo que es sha512 el algoritmo utilizado así que:
`john --format=sha512crypt hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt`

## Crack linux hashes with Hashcat

El tipo 1800 es el correspondiente a sha512crypt por lo que:
`hashcat -m 1800 -a 3 hashes.txt /usr/share/wordlists/rockyou.txt`

